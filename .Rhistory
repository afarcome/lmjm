# compute functions
l2 = l3 = 0
for(i in 1:n){
tmp0 = xiv*phi+as.vector(W[i,]%*%psiv)
mi = sum(btv<=tv[i])
for(m in 1:mi){
if(any(TT[i,]==btv[m],na.rm=TRUE)){
j = which(TT[i,]==btv[m])
muv = xiv+as.vector(X[i,j,]%*%bev)
if(type=="norm") l2 = l2-1/2*(lsi2pi+(Y[i,j]-muv)^2/si2)%*%Pp1[,m,i]
if(type=="bin"){
muv = exp(muv)/(1+exp(muv))
l2 = l2+(Y[i,j]*log(muv)+(1-Y[i,j])*log(1-muv))%*%Pp1[,m,i]
}
}
}
if(mi>1) for(m in 2:mi) l3 = l3-(exp(tmp0)*dbtvnu[m-1])%*%Pp1[,m,i]
l3 = l3+(dev[i]*(log(nu)+(nu-1)*log(tv[i])+tmp0)-exp(tmp0)*(tv[i]^nu-btvnu[mi]))%*%Pp1[,m,i]
}
l23 = as.vector(l2+l3)
}
# ---------------------------------------------------------------------------------------------------
dlk_comp_joint_HM <- function(par,piv,Pi,si2,type,TT,X,W,Y,jv,btv,Pp1,dev,tv){
k=length(piv)
# to compute the derivative of lk_comp_joint_HM
npX=dim(X)[3]
# preliminaries
bev = par[1:npX]; nu=nuv = par[npX+1]; xiv = par[(npX+2):(k+npX+1)]; phi = par[k+npX+2]; psiv = par[(k+npX+3):length(par)]
n = nrow(TT)
M = length(btv)
btvnu = btv^nu
dbtvnu = diff(btvnu)
# compute functions
dl2bev = rep(0,2)
dl3nu = 0
dl2xiv = dl3xiv = rep(0,3)
dl3phi = 0
dl3psiv = rep(0,3)
for(i in 1:n){
tmp0 = exp(xiv*phi+as.vector(W[i,]%*%psiv))
mi = sum(btv<=tv[i])
for(m in 1:mi){
if(any(TT[i,]==btv[m],na.rm=TRUE)){
j = which(TT[i,]==btv[m])
muv = xiv+as.vector(X[i,j,]%*%bev)
if(type=="norm"){
dl2bev = dl2bev+X[i,j,]*as.vector(((Y[i,j]-muv)/si2)%*%Pp1[,m,i])
dl2xiv = dl2xiv+(Y[i,j]-muv)/si2*Pp1[,m,i]
}
if(type=="bin"){
muv = exp(muv)/(1+exp(muv))
dl2bev = dl2bev+X[i,j,]*as.vector((Y[i,j]-muv)%*%Pp1[,m,i])
dl2bev = dl2bev+(Y[i,j]-muv)*Pp1[,m,i]
}
}
}
if(mi>1) for(m in 2:mi){
if(btv[m-1]>0) tmp = log(btv[m-1]) else tmp = 0
dl3nu = dl3nu-(tmp0*(log(btv[m])*btvnu[m]-tmp*btvnu[m-1]))%*%Pp1[,m,i]
dl3xiv = dl3xiv-(tmp0*dbtvnu[m-1])*phi*Pp1[,m,i]
dl3phi = dl3phi-(tmp0*dbtvnu[m-1]*xiv)%*%Pp1[,m,i]
dl3psiv = dl3psiv-W[i,]*(tmp0*dbtvnu[m-1])%*%Pp1[,m,i]
}
if(btv[mi]>0) tmp = log(btv[mi]) else tmp = 0
dl3nu = dl3nu+(dev[i]*(1/nu+log(tv[i]))-tmp0*(log(tv[i])*tv[i]^nu-tmp*btvnu[mi]))%*%Pp1[,m,i]
dl3xiv = dl3xiv+(dev[i]*phi-tmp0*(tv[i]^nu-btvnu[mi])*phi)*Pp1[,m,i]
dl3phi = dl3phi+(dev[i]*xiv-tmp0*(tv[i]^nu-btvnu[mi])*xiv)%*%Pp1[,m,i]
dl3psiv = dl3psiv+W[i,]*(dev[i]-tmp0*(tv[i]^nu-btvnu[mi]))%*%Pp1[,m,i]
}
dl23 = c(dl2bev,dl3nu,dl2xiv+dl3xiv,dl3phi,dl3psiv)
}
for(u in 1:k) for(j in 1:tjv[i]) sv[utU[i,j]
lk1 = sum(tnv*piv)
for(u in 1:k) lk1 = lk1+sum(tN[u,-u]*log(Q[u,-u]))
print(lk1)
}
# ---------------------------------------------------------------------------------------------------
lk_comp_joint_HM <- function(par,piv,Pi,si2,type,TT,X,W,Y,jv,btv,Pp1,dev,tv){
k=length(piv)
# to compute the second and third components of the expect complete log-likelihood
# preliminaries
npX=dim(X)[3]
bev = par[1:npX]; nu = nuv = par[npX+1]; xiv = par[(npX+2):(k+npX+1)]; phi = par[k+npX+2]; psiv = par[(k+npX+3):length(par)]
n = nrow(TT)
M = length(btv)
btvnu = btv^nu
dbtvnu = diff(btvnu)
lsi2pi = log(si2)+log(2*pi)
# compute functions
l2 = l3 = 0
for(i in 1:n){
tmp0 = xiv*phi+as.vector(W[i,]%*%psiv)
mi = sum(btv<=tv[i])
for(m in 1:mi){
if(any(TT[i,]==btv[m],na.rm=TRUE)){
j = which(TT[i,]==btv[m])
muv = xiv+as.vector(X[i,j,]%*%bev)
if(type=="norm") l2 = l2-1/2*(lsi2pi+(Y[i,j]-muv)^2/si2)%*%Pp1[,m,i]
if(type=="bin"){
muv = exp(muv)/(1+exp(muv))
l2 = l2+(Y[i,j]*log(muv)+(1-Y[i,j])*log(1-muv))%*%Pp1[,m,i]
}
}
}
if(mi>1) for(m in 2:mi) l3 = l3-(exp(tmp0)*dbtvnu[m-1])%*%Pp1[,m,i]
l3 = l3+(dev[i]*(log(nu)+(nu-1)*log(tv[i])+tmp0)-exp(tmp0)*(tv[i]^nu-btvnu[mi]))%*%Pp1[,m,i]
}
l23 = as.vector(l2+l3)
}
# ---------------------------------------------------------------------------------------------------
dlk_comp_joint_HM <- function(par,piv,Pi,si2,type,TT,X,W,Y,jv,btv,Pp1,dev,tv){
k=length(piv)
# to compute the derivative of lk_comp_joint_HM
npX=dim(X)[3]
# preliminaries
bev = par[1:npX]; nu=nuv = par[npX+1]; xiv = par[(npX+2):(k+npX+1)]; phi = par[k+npX+2]; psiv = par[(k+npX+3):length(par)]
n = nrow(TT)
M = length(btv)
btvnu = btv^nu
dbtvnu = diff(btvnu)
# compute functions
dl2bev = rep(0,2)
dl3nu = 0
dl2xiv = dl3xiv = rep(0,3)
dl3phi = 0
dl3psiv = rep(0,3)
for(i in 1:n){
tmp0 = exp(xiv*phi+as.vector(W[i,]%*%psiv))
mi = sum(btv<=tv[i])
for(m in 1:mi){
if(any(TT[i,]==btv[m],na.rm=TRUE)){
j = which(TT[i,]==btv[m])
muv = xiv+as.vector(X[i,j,]%*%bev)
if(type=="norm"){
dl2bev = dl2bev+X[i,j,]*as.vector(((Y[i,j]-muv)/si2)%*%Pp1[,m,i])
dl2xiv = dl2xiv+(Y[i,j]-muv)/si2*Pp1[,m,i]
}
if(type=="bin"){
muv = exp(muv)/(1+exp(muv))
dl2bev = dl2bev+X[i,j,]*as.vector((Y[i,j]-muv)%*%Pp1[,m,i])
dl2bev = dl2bev+(Y[i,j]-muv)*Pp1[,m,i]
}
}
}
if(mi>1) for(m in 2:mi){
if(btv[m-1]>0) tmp = log(btv[m-1]) else tmp = 0
dl3nu = dl3nu-(tmp0*(log(btv[m])*btvnu[m]-tmp*btvnu[m-1]))%*%Pp1[,m,i]
dl3xiv = dl3xiv-(tmp0*dbtvnu[m-1])*phi*Pp1[,m,i]
dl3phi = dl3phi-(tmp0*dbtvnu[m-1]*xiv)%*%Pp1[,m,i]
dl3psiv = dl3psiv-W[i,]*(tmp0*dbtvnu[m-1])%*%Pp1[,m,i]
}
if(btv[mi]>0) tmp = log(btv[mi]) else tmp = 0
dl3nu = dl3nu+(dev[i]*(1/nu+log(tv[i]))-tmp0*(log(tv[i])*tv[i]^nu-tmp*btvnu[mi]))%*%Pp1[,m,i]
dl3xiv = dl3xiv+(dev[i]*phi-tmp0*(tv[i]^nu-btvnu[mi])*phi)*Pp1[,m,i]
dl3phi = dl3phi+(dev[i]*xiv-tmp0*(tv[i]^nu-btvnu[mi])*xiv)%*%Pp1[,m,i]
dl3psiv = dl3psiv+W[i,]*(dev[i]-tmp0*(tv[i]^nu-btvnu[mi]))%*%Pp1[,m,i]
}
dl23 = c(dl2bev,dl3nu,dl2xiv+dl3xiv,dl3phi,dl3psiv)
}
Q
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
est
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
est
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
est
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
est
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
tN
sv
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
est
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
est
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
est
tT[1,]
sum(tT,1,max,na.rm=TRUE)
sum(tT,1,max,rm.na=TRUE)
apply(tT,1,max,rm.na=TRUE)
apply(tT,1,max,na.rm=TRUE)
sum(apply(tT,1,max,na.rm=TRUE))
sum(est$sv)
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
sum(est$sv)
sum(apply(tT,1,max,na.rm=TRUE))
est$Q
est$piv
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source("est_comp_joint_HMcontinuous.R")
est = est_comp_joint_HMcontinuous(tT,tU,TT,W,X,tv,dev,k=3,type="norm")
source("est_comp_joint_HMcontinuous.R")
est = est_comp_joint_HMcontinuous(tT,tU,TT,W,X,tv,dev,k=3,type="norm")
est$tnv
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
est
sum(est$tnv)
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source("est_comp_joint_HMcontinuous.R")
est = est_comp_joint_HMcontinuous(tT,tU,TT,W,X,tv,dev,k=3,type="norm")
source("est_comp_joint_HMcontinuous.R")
est = est_comp_joint_HMcontinuous(tT,tU,TT,W,X,tv,dev,k=3,type="norm")
source("est_comp_joint_HMcontinuous.R")
est = est_comp_joint_HMcontinuous(tT,tU,TT,W,X,tv,dev,k=3,type="norm")
source("est_comp_joint_HMcontinuous.R")
est = est_comp_joint_HMcontinuous(tT,tU,TT,W,X,tv,dev,k=3,type="norm")
source("est_comp_joint_HMcontinuous.R")
est = est_comp_joint_HMcontinuous(tT,tU,TT,W,X,tv,dev,k=3,type="norm")
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source("est_comp_joint_HMcontinuous.R")
est = est_comp_joint_HMcontinuous(tT,tU,TT,W,X,tv,dev,k=3,type="norm")
X
dim(X)
X[1,,]
dmi(X)
dim(X)
ncol(W)
X[1,]
W[1,]
W[2,]
W[3,]
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
xiv
psiv
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
ncovX
ncovQ
ncovW
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
xiv
bev
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
psiv
bev
xiv
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
Y
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
ls(out)
out$TT0
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
as.vector(X1[i,j,]%*%bev)
xiv[tU[i,tj]]
tU[i,tj]
tj
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
par
bev
eta
nu
xiv
phi
psiv
par
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
warnings8)
warnings())
warnings()
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
dlk3eta
if(tT[i,di]>0) tmp = log(tT[di]) else tmp = 0
dlk3eta = dlk3eta+(dev[i]*(1+nu*log(tv[i]))-exp(xiv[tU[i,di]]+tmp0)*(log(tv[i])*tv[i]^nu-tmp*tT[di]^nu))*nu
dlk3xiv = dlk3xiv+(dev[i]*phi-tmp0*(tv[i]^nu-tT[i,di]^nu)*phi)
dlk3phi = dlk3phi+(dev[i]*xiv-tmp0*(tv[i]^nu-tT[i,di]^nu)*xiv)
dlk3psiv = dlk3psiv+W1[i,]*(dev[i]-exp(xiv[tU[i,di]]+tmp0)*(tv[i]^nu-tT[i,di]^nu))
dlk3eta
dlk3eta
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
dlk3eta
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
dlk3eta
if(tT[i,di]>0) tmp = log(tT[di]) else tmp = 0
dlk3eta = dlk3eta+(dev[i]*(1+nu*log(tv[i]))-exp(xiv[tU[i,di]]+tmp0)*(log(tv[i])*tv[i]^nu-tmp*tT[di]^nu))*nu
dlk3xiv = dlk3xiv+(dev[i]*phi-tmp0*(tv[i]^nu-tT[i,di]^nu)*phi)
dlk3phi = dlk3phi+(dev[i]*xiv-tmp0*(tv[i]^nu-tT[i,di]^nu)*xiv)
dlk3psiv = dlk3psiv+W1[i,]*(dev[i]-exp(xiv[tU[i,di]]+tmp0)*(tv[i]^nu-tT[i,di]^nu))
dlk3eta
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
elk3eta
dlk3eta
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
log(tT[di])
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
est$bev
est$xiv
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
est$bev
est$xiv
est$nu
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/est_comp_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
source('~/Dropbox/Collaborazioni/Farcomeni/lmjmSurv/code/final/example_joint_HMcontinuous.R')
eta
est
est = est_comp_joint_HMcontinuous(tT,tU,TT,W,X,Y,tv,dev,k=3,type="norm")
est
est$eta
est$nu
